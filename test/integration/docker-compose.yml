version: "3"
services:
  regtest-0:
    image: kylemanna/bitcoind
    command: bitcoind -regtest -dnsseed -server -listen -rest -rpcbind=0.0.0.0:19001 -rpcuser=admin1 -rpcpassword=123 -rpcport=19001 -rpcallowip=0.0.0.0/0 -deprecatedrpc=generate -disablewallet=0 -addnode=regtest-1:18444 -addnode=regtest-2:18444
    expose:
      - "18444"
  regtest-1:
    image: kylemanna/bitcoind
    command: bitcoind -regtest -dnsseed -server -listen -rest -rpcbind=0.0.0.0:19011 -rpcuser=admin1 -rpcpassword=123 -rpcport=19011 -rpcallowip=0.0.0.0/0 -deprecatedrpc=generate -disablewallet=0 -addnode=regtest-0:18444 -addnode=regtest-2:18444
    expose:
      - "18444"
    depends_on:
      - regtest-0
      - regtest-2
  regtest-2:
    image: kylemanna/bitcoind
    command: bitcoind -regtest -dnsseed -server -listen -rest -rpcbind=0.0.0.0:19021 -rpcuser=admin1 -rpcpassword=123 -rpcport=19021 -rpcallowip=0.0.0.0/0 -deprecatedrpc=generate -disablewallet=0 -addnode=regtest-0:18444 -addnode=regtest-1:18444
    expose:
      - "18444"
    depends_on:
      - regtest-0
  lightning:
    build: ../../
    environment:
      RUST_BACKTRACE: full
      TERM: xterm
    depends_on:
      - regtest-0
      - regtest-1
      - regtest-2
